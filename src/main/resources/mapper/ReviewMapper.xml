<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xx.bootblog.mapper.ReviewMapper" >
  <resultMap id="BaseResultMap" type="com.xx.bootblog.domain.Review" >
    <id column="aid" property="aid" jdbcType="INTEGER" />
    <result column="message" property="message" jdbcType="VARCHAR" />
    <result column="rtime" property="rtime" jdbcType="TIMESTAMP" />
    <association property="user" javaType="User">
      <id column="uid" property="uid" jdbcType="INTEGER" />
      <result column="uname" property="uname" jdbcType="VARCHAR" />
      <result column="email" property="email" jdbcType="VARCHAR" />
      <result column="password" property="password" jdbcType="VARCHAR" />
      <result column="headimg" property="headimg" jdbcType="VARCHAR"/>
    </association>
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="map" >
    delete from review
    where aid = #{aid,jdbcType=INTEGER}
      and uid = #{uid,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.xx.bootblog.domain.Review" >
    insert into review (aid, uid, message,rtime
      )
    values (#{aid}, #{user.uid}, #{message},#{rtime}
      )
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.xx.bootblog.domain.Review" >
    update review
    set message = #{message,jdbcType=VARCHAR},rtime=#{rtime}
    where aid = #{aid,jdbcType=INTEGER}
      and uid = #{uid,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="map" >
    select aid, uid, message,rtime,headimg
    from review
    where aid = #{aid,jdbcType=INTEGER}
      and uid = #{uid,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap" >
    select aid, uid, message,rtime,headimg
    from review
  </select>
  <select id="selectByAid" resultMap="BaseResultMap">
    select message,r.uid,uname,rtime,headimg
    from review r,user u
    where aid = #{aid} and r.uid = u.uid
  </select>
  <select id="getTotal" resultType="java.lang.Long">
    select count(*)
    from review
  </select>

</mapper>